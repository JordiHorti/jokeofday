{"version":3,"file":"categories.min.js","sources":["../../../src/datafilter/filtertypes/categories.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Filter managing display of subcategories questions.\n *\n * @module     qbank_managecategories/datafilter/filtertypes/categories\n * @author     Mark Johnson <mark.johnson@catalyst-eu.net>\n * @copyright  2023 Catalyst IT Europe Ltd.\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport GenericFilter from 'core/datafilter/filtertype';\nimport Templates from 'core/templates';\nimport {getUserPreference, setUserPreference} from 'core_user/repository';\n\nexport default class extends GenericFilter {\n\n    SELECTORS = {\n        includeSubcategories: 'input[name=category-subcategories]',\n    };\n\n    /**\n     * Construct a new categoires filter\n     *\n     * @param {String} filterType The type of filter that this relates to (categories)\n     * @param {HTMLElement} rootNode The root node for the participants filterset\n     * @param {Array} initialValues The currently selected category IDs.\n     * @param {Object} filterOptions An object containing the additional options for the filter, currently \"includesubcategories\"\n     *     is supported, which if true will display the \"Also show questions from subcategories\" checkbox as checked.\n     */\n    constructor(filterType, rootNode, initialValues, filterOptions = {includesubcategories: false}) {\n        super(filterType, rootNode, initialValues);\n        this.addSubcategoryCheckbox(filterOptions.includesubcategories);\n    }\n\n    async addSubcategoryCheckbox(checked = null) {\n        const filterValueNode = this.getFilterValueNode();\n        if (checked === null || checked === undefined) {\n            checked = await getUserPreference('qbank_managecategories_includesubcategories_filter_default');\n        } else {\n            setUserPreference('qbank_managecategories_includesubcategories_filter_default', checked);\n        }\n        const {html} = await Templates.renderForPromise('qbank_managecategories/include_subcategories_checkbox', {\n            checked: checked && checked !== '0',\n        });\n        filterValueNode.insertAdjacentHTML('afterend', html);\n    }\n\n    get filterOptions() {\n        return [\n            {name: 'includesubcategories', value: this.filterRoot.querySelector(this.SELECTORS.includeSubcategories).checked}\n        ];\n    }\n\n    get filterValue() {\n        return {\n            name: this.name,\n            jointype: this.jointype,\n            values: this.values,\n            filteroptions: this.filterOptions,\n        };\n    }\n}\n"],"names":["_interopRequireDefault","e","__esModule","default","_filtertype","_templates","_default","GenericFilter","SELECTORS","includeSubcategories","constructor","filterType","rootNode","initialValues","filterOptions","arguments","length","undefined","includesubcategories","super","this","addSubcategoryCheckbox","checked","filterValueNode","getFilterValueNode","getUserPreference","setUserPreference","html","Templates","renderForPromise","insertAdjacentHTML","name","value","filterRoot","querySelector","filterValue","jointype","values","filteroptions","_exports"],"mappings":"0MAyBuC,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA;;;;;;;;qFADvCG,YAAAJ,uBAAAI,aACAC,WAAAL,uBAAAK,YAGe,MAAAC,iBAAcC,YAAAA,QAEzBC,UAAY,CACRC,qBAAsB,sCAY1BC,WAAAA,CAAYC,WAAYC,SAAUC,eAA8D,IAA/CC,cAAaC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,CAACG,sBAAsB,GACpFC,MAAMR,WAAYC,SAAUC,eAC5BO,KAAKC,uBAAuBP,cAAcI,qBAC9C,CAEA,4BAAMG,GAAuC,IAAhBC,QAAOP,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACnC,MAAMQ,gBAAkBH,KAAKI,qBACzBF,cACAA,cAAgB,EAAAG,YAAiBA,mBAAC,+DAElC,EAAAC,YAAiBA,mBAAC,6DAA8DJ,SAEpF,MAAMK,KAACA,YAAcC,WAAAA,QAAUC,iBAAiB,wDAAyD,CACrGP,QAASA,SAAuB,MAAZA,UAExBC,gBAAgBO,mBAAmB,WAAYH,KACnD,CAEA,iBAAIb,GACA,MAAO,CACH,CAACiB,KAAM,uBAAwBC,MAAOZ,KAAKa,WAAWC,cAAcd,KAAKZ,UAAUC,sBAAsBa,SAEjH,CAEA,eAAIa,GACA,MAAO,CACHJ,KAAMX,KAAKW,KACXK,SAAUhB,KAAKgB,SACfC,OAAQjB,KAAKiB,OACbC,cAAelB,KAAKN,cAE5B,EACH,OAAAyB,SAAApC,QAAAG,SAAAiC,SAAApC,OAAA"}