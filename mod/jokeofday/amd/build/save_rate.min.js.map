{"version":3,"file":"save_rate.min.js","sources":["../src/save_rate.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n    'jquery',\n    'core/ajax',\n\n], function ($, Ajax) {\n    \"use strict\";\n\n    let ACTIONS = {\n        RATING: '[data-action=\"rating\"]'\n    };\n    let SERVICES = {\n        RATING: 'mod_jokeofday_save_rating'\n    };\n\n\n    /**\n     * @param {String} region\n     * @param {Number} id\n     * @constructor\n     */\n    function Joke(region, id) {\n        console.log('Entra por constructor', id);\n        this.node = $(region);\n        this.id = id;\n        console.log('Joke ID:', this.id);\n        this.text = this.node.find('.card-text').text();\n        this.node.find(ACTIONS.RATING + '[data-id=\"' + id + '\"]').on('change', this.changeRating.bind(this));\n    }\n\n    Joke.prototype.changeRating = function (e) {\n        let rating = $(e.currentTarget).val();\n        console.log(\"Rating:\", rating);\n        console.log(\"Joke ID:\", this.id);\n\n        const request = {\n            methodname: SERVICES.RATING,\n            args: {\n                rating: rating,\n                jokeid: this.id,\n            }\n        };\n        Ajax.call([request])[0].done(function (response) {\n            console.log(response);\n            if (response.status == 1) {\n                // eslint-disable-next-line no-alert\n                alert(response.message);\n            } else if (response.status === 'error') {\n                // eslint-disable-next-line no-alert\n                alert(response.message);\n            }\n        }).fail(function (fail) {\n            console.log(fail);\n        });\n    };\n\n    Joke.prototype.node = null;\n\n    return {\n        /**\n         * @param {String} region\n         * @param {Number} id\n         * @return {Joke}\n         */\n        init: function (region, id) {\n            console.log('Iniciamos JS', region, id);\n            return new Joke(region, id);\n        }\n    };\n});\n"],"names":["define","$","Ajax","ACTIONS","SERVICES","Joke","region","id","console","log","this","node","text","find","on","changeRating","bind","prototype","e","rating","currentTarget","val","request","methodname","args","jokeid","call","done","response","status","alert","message","fail","init"],"mappings":"AAsBAA,OAAM,0BAAC,CACH,SACA,cAED,SAAUC,EAAGC,MAGZ,IAAIC,eACQ,yBAERC,gBACQ,4BASZ,SAASC,KAAKC,OAAQC,IAClBC,QAAQC,IAAI,wBAAyBF,IACrCG,KAAKC,KAAOV,EAAEK,QACdI,KAAKH,GAAKA,GACVC,QAAQC,IAAI,WAAYC,KAAKH,IAC7BG,KAAKE,KAAOF,KAAKC,KAAKE,KAAK,cAAcD,OACzCF,KAAKC,KAAKE,KAAKV,eAAiB,aAAeI,GAAK,MAAMO,GAAG,SAAUJ,KAAKK,aAAaC,KAAKN,MAClG,CA8BA,OA5BAL,KAAKY,UAAUF,aAAe,SAAUG,GACpC,IAAIC,OAASlB,EAAEiB,EAAEE,eAAeC,MAChCb,QAAQC,IAAI,UAAWU,QACvBX,QAAQC,IAAI,WAAYC,KAAKH,IAE7B,MAAMe,QAAU,CACZC,WAAYnB,gBACZoB,KAAM,CACFL,OAAQA,OACRM,OAAQf,KAAKH,KAGrBL,KAAKwB,KAAK,CAACJ,UAAU,GAAGK,MAAK,SAAUC,UACnCpB,QAAQC,IAAImB,WACW,GAAnBA,SAASC,QAGkB,UAApBD,SAASC,SADhBC,MAAMF,SAASG,QAKvB,IAAGC,MAAK,SAAUA,MACdxB,QAAQC,IAAIuB,KAChB,KAGJ3B,KAAKY,UAAUN,KAAO,KAEf,CAMHsB,KAAM,SAAU3B,OAAQC,IAEpB,OADAC,QAAQC,IAAI,eAAgBH,OAAQC,IAC7B,IAAIF,KAAKC,OAAQC,GAC5B,EAER"}